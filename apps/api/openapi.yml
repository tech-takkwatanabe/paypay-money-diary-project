openapi: 3.1.0
info:
  title: PayPay Money Diary API
  version: 1.0.0
  description: PayPay 家計簿アプリケーション API
servers:
  - url: https://localhost:8080/api
    description: Development server
components:
  securitySchemes:
    Bearer:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    UserResponse:
      type: object
      properties:
        uuid:
          type: string
          description: ユーザーID
        name:
          type: string
          description: ユーザー名
        email:
          type: string
          format: email
          description: メールアドレス
      required:
        - uuid
        - name
        - email
    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          description: エラーメッセージ
      required:
        - error
    TokensResponse:
      type: object
      properties:
        accessToken:
          type: string
          description: アクセストークン
        refreshToken:
          type: string
          description: リフレッシュトークン
      required:
        - accessToken
        - refreshToken
    RefreshTokenRequest:
      type: object
      properties:
        refreshToken:
          type: string
          description: リフレッシュトークン
      required:
        - refreshToken
  parameters: {}
paths:
  /auth/signup:
    post:
      tags:
        - 認証
      summary: ユーザー登録
      description: 新規ユーザーを登録します
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  minLength: 1
                email:
                  type: string
                  format: email
                password:
                  type: string
                  minLength: 8
              required:
                - name
                - email
                - password
      responses:
        "201":
          description: 登録成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    $ref: "#/components/schemas/UserResponse"
                required:
                  - user
        "400":
          description: バリデーションエラー
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "409":
          description: ユーザー既存
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /auth/login:
    post:
      tags:
        - 認証
      summary: ログイン
      description: メールアドレスとパスワードでログインします
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
                  minLength: 1
              required:
                - email
                - password
      responses:
        "200":
          description: ログイン成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    $ref: "#/components/schemas/UserResponse"
                  tokens:
                    $ref: "#/components/schemas/TokensResponse"
                required:
                  - user
                  - tokens
        "400":
          description: バリデーションエラー
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: 認証失敗
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /auth/refresh:
    post:
      tags:
        - 認証
      summary: トークン更新
      description: リフレッシュトークンを使用して新しいアクセストークンを取得します
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshTokenRequest"
      responses:
        "200":
          description: 更新成功
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TokensResponse"
        "400":
          description: リフレッシュトークン不足
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          description: 無効なトークン
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /auth/logout:
    post:
      tags:
        - 認証
      summary: ログアウト
      description: リフレッシュトークンを無効化してログアウトします
      security:
        - Bearer: []
      responses:
        "200":
          description: ログアウト成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                required:
                  - message
        "401":
          description: 認証エラー
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
  /auth/me:
    get:
      tags:
        - 認証
      summary: ユーザー情報取得
      description: 認証済みユーザーの情報を取得します
      security:
        - Bearer: []
      responses:
        "200":
          description: 取得成功
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    $ref: "#/components/schemas/UserResponse"
                required:
                  - user
        "401":
          description: 認証エラー
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
